// ==========================================
// 1. 用户表 (User) - user.prisma
// ==========================================
model User {
  id       Int     @id @default(autoincrement())
  username String  @unique
  password String
  nickname String?
  phone    String? // 新增：手机号 (企业级常见)
  email    String?
  avatar   String?
  status   Int     @default(1) // 1:正常 0:停用
  remark   String? // 新增：备注

  deptId Int?
  dept   Department? @relation("DeptUsers", fields: [deptId], references: [id])

  roles Role[]

  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  deletedAt   DateTime? // 新增：软删除标志
  departments Department[]
}

// ==========================================
// 2. 角色表 (Role)
// ==========================================
model Role {
  id       Int    @id @default(autoincrement())
  roleName String // 替换原本的description：角色名称 (如 超级管理员)
  roleKey  String @unique // 替换原本的name：角色权限字符串 (如 admin)
  sort     Int    @default(0) // 新增：角色排序
  status   Int    @default(1)

  // ★★★ 新增：数据权限核心字段 ★★★
  dataScope Int @default(1) // 1:全部数据权限 2:自定数据权限 3:本部门数据权限 4:本部门及以下数据权限 5:仅本人数据权限

  users User[]
  menus Menu[]

  // 新增：当 dataScope=2 时，角色具体关联的部门集合 (用于自定数据权限)
  depts Department[] @relation("RoleDepts")

  remark    String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime? // 软删除
}

model Todo {
  id        Int      @id @default(autoincrement())
  title     String   @db.VarChar(255)
  completed Boolean  @default(false)
  createdAt DateTime @default(now())
}
